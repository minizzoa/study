<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>íŒŒì›Œ ë‘ë”ì§€ ì¡ê¸° Pro</title>
    <style>
        :root { 
            --bg-color: #2c3e50; 
            --primary: #f1c40f; 
            --success: #27ae60; 
            --danger: #e74c3c; 
            --mole-color: #a1887f;
        }

        body { 
            text-align: center; 
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; 
            background-color: var(--bg-color); 
            color: white; 
            margin: 0; 
            padding: env(safe-area-inset-top) 0;
            touch-action: manipulation; 
            user-select: none;
            overflow-x: hidden;
        }
        
        h1 { margin: 15px 0; font-size: 1.8rem; color: var(--primary); text-shadow: 2px 2px #000; }
        
        .score-board { 
            font-size: 1.1rem; margin-bottom: 10px; background: rgba(0,0,0,0.4); 
            display: inline-block; padding: 10px 20px; border-radius: 15px; border: 1px solid #444;
        }

        /* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ ë ˆì´ì•„ì›ƒ */
        .controls { margin-bottom: 15px; display: flex; justify-content: center; gap: 8px; }
        button { 
            padding: 10px 15px; font-size: 0.9rem; cursor: pointer; border: none; 
            border-radius: 12px; font-weight: bold; transition: 0.2s; box-shadow: 0 4px #1a252f;
        }
        button:active { transform: translateY(2px); box-shadow: 0 2px #1a252f; }
        
        .btn-start { background: var(--success); color: white; }
        .btn-pause { background: #3498db; color: white; }
        .btn-sound { background: #95a5a6; color: white; width: 80px; }

        /* ë°˜ì‘í˜• ê·¸ë¦¬ë“œ */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 15px; 
            width: 90%; 
            max-width: 400px; 
            margin: 10px auto;
        }
        .hole { 
            aspect-ratio: 1/1; 
            background-color: #4e342e; 
            border-radius: 50%; 
            position: relative; 
            overflow: hidden; 
            border: 5px solid #3e2723;
            box-shadow: inset 0 10px 0 rgba(0,0,0,0.5);
        }
        
        /* ë‘ë”ì§€ ìºë¦­í„° */
        .mole { 
            width: 80%; 
            height: 90%; 
            position: absolute; 
            left: 10%; 
            top: 100%; 
            transition: top 0.12s ease-out; 
            cursor: pointer;
            background-color: var(--mole-color); 
            border-radius: 50% 50% 20% 20%;
            /* ì¤‘ì•™ ì •ë ¬ */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 25px;
            box-sizing: border-box;
        }

        /* ë‘ë”ì§€ ëˆˆ */
        .mole::before { 
            content: 'â— â—'; 
            color: #2d3436; 
            font-size: 12px; 
            letter-spacing: 12px;
            margin-left: 10px; /* ì¹˜ìš°ì¹¨ ë°©ì§€ */
            margin-bottom: 4px;
        }

        /* ë‘ë”ì§€ ì½”/ì… */
        .mole::after { 
            content: 'â–¿'; 
            color: #ff7675; 
            font-size: 22px; 
            font-weight: bold;
            line-height: 1;
        }

        .mole.up { top: 20%; }

        /* ê²Œì„ ì˜¤ë²„/ì˜¤ë²„ë ˆì´ */
        .overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); flex-direction: column; justify-content: center; 
            align-items: center; z-index: 100;
        }
        .overlay h2 { font-size: 3rem; margin: 0 0 15px 0; color: var(--primary); }
    </style>
</head>
<body>

    <h1>ğŸ”¨ ë‘ë”ì§€ ëŒ€ì†Œë™!</h1>
    
    <div class="score-board">
        ì ìˆ˜: <span id="score">0</span> | ì‹œê°„: <span id="time">20</span>s<br>
        <span style="color:#ff7675; font-size: 0.9rem;">ğŸ† Best Record: <span id="high-score">0</span></span>
    </div>

    <div class="controls">
        <button class="btn-start" onclick="startGame()">ê²Œì„ ì‹œì‘</button>
        <button class="btn-pause" id="pauseBtn" onclick="togglePause()">ì¼ì‹œì •ì§€</button>
        <button class="btn-sound" id="soundBtn" onclick="toggleSound()">ğŸ”Š ON</button>
    </div>

    <div class="grid" id="grid"></div>

    <div id="game-over" class="overlay">
        <h2>TIME UP!</h2>
        <p id="final-result" style="font-size: 1.5rem; margin-bottom: 25px;"></p>
        <button class="btn-start" style="padding: 15px 40px; font-size: 1.2rem;" onclick="closeGameOver()">ë‹¤ì‹œ ë„ì „</button>
    </div>

    <script>
        const grid = document.querySelector('#grid');
        const scoreBoard = document.querySelector('#score');
        const timeBoard = document.querySelector('#time');
        const highScoreBoard = document.querySelector('#high-score');
        const gameOverScreen = document.querySelector('#game-over');
        const finalResultText = document.querySelector('#final-result');
        const pauseBtn = document.querySelector('#pauseBtn');
        const soundBtn = document.querySelector('#soundBtn');

        let score = 0, timeLeft = 20, isPlaying = false, isPaused = false, isSoundOn = true;
        let gameTimer, moleTimer;
        let highScore = localStorage.getItem('moleHighScorePro') || 0;
        highScoreBoard.innerText = highScore;

        // êµ¬ë© 9ê°œ ìƒì„±
        for (let i = 0; i < 9; i++) {
            const hole = document.createElement('div');
            hole.classList.add('hole');
            hole.innerHTML = `<div class="mole"></div>`;
            grid.appendChild(hole);
        }
        const moles = document.querySelectorAll('.mole');

        function toggleSound() {
            isSoundOn = !isSoundOn;
            soundBtn.innerText = isSoundOn ? "ğŸ”Š ON" : "ğŸ”‡ OFF";
        }

        function togglePause() {
            if (!isPlaying) return;
            isPaused = !isPaused;
            pauseBtn.innerText = isPaused ? "ê³„ì†í•˜ê¸°" : "ì¼ì‹œì •ì§€";
            pauseBtn.style.backgroundColor = isPaused ? "#e67e22" : "#3498db";
        }

        function playHitSound() {
            if (!isSoundOn) return;
            const context = new (window.AudioContext || window.webkitAudioContext)();
            const osc = context.createOscillator();
            const gain = context.createGain();
            osc.frequency.setValueAtTime(500, context.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, context.currentTime + 0.1);
            gain.gain.fadeOut = 0.1;
            osc.connect(gain); gain.connect(context.destination);
            osc.start(); osc.stop(context.currentTime + 0.1);
        }

        function startGame() {
            if (isPlaying) return;
            score = 0; timeLeft = 20; isPaused = false;
            scoreBoard.innerText = score; timeBoard.innerText = timeLeft;
            isPlaying = true; gameOverScreen.style.display = 'none';
            pauseBtn.innerText = "ì¼ì‹œì •ì§€";

            gameTimer = setInterval(() => {
                if (!isPaused) {
                    timeLeft--;
                    timeBoard.innerText = timeLeft;
                    if (timeLeft <= 0) endGame();
                }
            }, 1000);
            showMole();
        }

        function showMole() {
            if (!isPlaying) return;
            
            moles.forEach(m => m.classList.remove('up'));

            if (!isPaused) {
                const randomIdx = Math.floor(Math.random() * moles.length);
                const mole = moles[randomIdx];
                mole.classList.add('up');
            }

            const displayTime = Math.random() * 600 + 400;
            moleTimer = setTimeout(showMole, displayTime);
        }

        function endGame() {
            clearInterval(gameTimer);
            clearTimeout(moleTimer);
            isPlaying = false;
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('moleHighScorePro', highScore);
                highScoreBoard.innerText = highScore;
            }
            finalResultText.innerText = `ìµœì¢… ì ìˆ˜: ${score}ì `;
            gameOverScreen.style.display = 'flex';
        }

        function closeGameOver() {
            gameOverScreen.style.display = 'none';
            startGame();
        }

        moles.forEach(mole => {
            // í´ë¦­ê³¼ í„°ì¹˜ ëª¨ë‘ ëŒ€ì‘
            const hit = (e) => {
                e.preventDefault();
                if (mole.classList.contains('up') && !isPaused && isPlaying) {
                    score++;
                    scoreBoard.innerText = score;
                    mole.classList.remove('up');
                    playHitSound();
                }
            };
            mole.addEventListener('mousedown', hit);
            mole.addEventListener('touchstart', hit);
        });
    </script>
</body>
</html>