<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Multi-Calculator</title>
    <style>
        :root {
            --bg-color: #121212;
            --calc-bg: #1e1e1e;
            --btn-num: #333333;
            --btn-op: #fca311;
            --btn-func: #ef476f;
            --btn-sci: #4cc9f0;
            --lcd-color: #00ffcc;
        }

        body {
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 5px 10px;
            font-family: 'Pretendard', sans-serif;
            box-sizing: border-box;
        }

        .main-title {
            font-size: 1.4rem;
            font-weight: 800;
            color: #fff;
            margin: 8px 0 12px 0;
            display: flex;
            align-items: center; gap: 8px;
        }

        .tabs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            margin-bottom: 10px;
            width: 100%;
            max-width: 360px;
        }
        .tab-btn {
            padding: 8px 0;
            border: none;
            border-radius: 8px;
            background: #2a2a2a;
            color: #888;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            transition: 0.2s;
        }
        .tab-btn.active { background: var(--btn-op); color: #000; }

        .calculator-container {
            background: var(--calc-bg);
            padding: 15px;
            border-radius: 22px;
            box-shadow: 10px 10px 30px #050505;
            width: 100%;
            max-width: 360px;
            box-sizing: border-box;
            border: 1px solid #333;
        }

        .display {
            width: 100%;
            height: 60px;
            background: #000;
            border-radius: 12px;
            text-align: right;
            padding: 10px 15px;
            font-size: 24px;
            font-weight: bold;
            color: var(--lcd-color);
            box-shadow: inset 4px 4px 10px #000;
            box-sizing: border-box;
            border: 1px solid #222;
            margin-bottom: 10px;
        }

        .expandable-section {
            display: grid;
            grid-template-rows: 0fr;
            transition: grid-template-rows 0.3s ease-out;
            overflow: hidden;
        }
        .expandable-section.active { grid-template-rows: 1fr; margin-bottom: 10px; }
        .section-content { min-height: 0; }

        .box-ui {
            background: #111;
            padding: 10px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .row-ui { display: flex; align-items: center; justify-content: space-between; gap: 5px; }
        select {
            flex: 1; height: 34px; background: #2a2a2a; color: #fff;
            border: none; padding: 0 5px; border-radius: 6px; font-size: 12px;
        }
        .res-ui {
            flex: 1; background: #333; color: var(--btn-op); height: 36px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 6px; font-size: 13px; font-weight: bold;
        }

        .info-bar-single {
            font-size: 10px; color: #999; text-align: center;
            background: rgba(255,255,255,0.05); padding: 5px;
            border-radius: 6px; margin-top: 6px;
        }

        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        button {
            height: 52px; border: none; border-radius: 12px;
            font-size: 20px; font-weight: 700; cursor: pointer;
            background: var(--btn-num); color: #fff; box-shadow: 3px 3px 6px #0a0a0a;
        }
        button:active { transform: scale(0.96); }
        .op { background: var(--btn-op); color: #000; }
        .func { background: var(--btn-func); font-size: 15px; }
        .sci { background: var(--btn-sci); color: #000; font-size: 13px; height: 38px; }
    </style>
</head>
<body>

    <h1 class="main-title">üî¢ Î©ÄÌã∞ Í≥ÑÏÇ∞Í∏∞</h1>

    <div class="tabs">
        <button class="tab-btn active" onclick="setMode('standard', this)">ÏùºÎ∞ò</button>
        <button class="tab-btn" onclick="setMode('scientific', this)">Í≥µÌïô</button>
        <button class="tab-btn" onclick="setMode('currency', this)">ÌôòÏú®</button>
        <button class="tab-btn" onclick="setMode('unit', this)">Îã®ÏúÑ</button>
    </div>

    <div class="calculator-container">
        <input type="text" id="screen" class="display" value="0" readonly>

        <div id="sci-container" class="expandable-section">
            <div class="section-content">
                <div class="grid" style="grid-template-rows: repeat(2, 1fr); margin-bottom: 5px;">
                    <button class="sci" onclick="input('Math.sin(')">sin</button>
                    <button class="sci" onclick="input('Math.cos(')">cos</button>
                    <button class="sci" onclick="input('Math.tan(')">tan</button>
                    <button class="sci" onclick="input('Math.PI')">œÄ</button>
                    <button class="sci" onclick="input('Math.sqrt(')">‚àö</button>
                    <button class="sci" onclick="input('Math.log10(')">log</button>
                    <button class="sci" onclick="input('Math.log(')">ln</button>
                    <button class="sci" onclick="input('**')">x ∏</button>
                </div>
            </div>
        </div>

        <div id="cur-container" class="expandable-section">
            <div class="section-content">
                <div class="box-ui">
                    <div class="row-ui">
                        <select id="fromCurr" onchange="convertCurrency()"><option value="USD" selected>USD ÎØ∏Íµ≠</option><option value="KRW">KRW ÌïúÍµ≠</option></select>
                        <span style="color:#fff">‚áÑ</span>
                        <select id="toCurr" onchange="convertCurrency()"><option value="KRW" selected>KRW ÌïúÍµ≠</option><option value="USD">USD ÎØ∏Íµ≠</option></select>
                    </div>
                    <div class="row-ui">
                        <div class="res-ui" id="currInputLabel">0 USD</div>
                        <div class="res-ui" id="currResultLabel">Í≤∞Í≥º</div>
                    </div>
                    <div class="info-bar-single" id="curInfoBar">ÌôòÏú® Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë...</div>
                </div>
            </div>
        </div>

        <div id="unit-container" class="expandable-section">
            <div class="section-content">
                <div class="box-ui">
                    <div class="row-ui">
                        <select id="unitType" onchange="updateUnitOptions()">
                            <option value="length">Í∏∏Ïù¥ (Length)</option>
                            <option value="weight">Î¨¥Í≤å (Weight)</option>
                        </select>
                    </div>
                    <div class="row-ui">
                        <select id="fromUnit" onchange="convertUnit()"></select>
                        <span style="color:#fff">‚áÑ</span>
                        <select id="toUnit" onchange="convertUnit()"></select>
                    </div>
                    <div class="res-ui" id="unitResultLabel" style="width:100%">Îã®ÏúÑ Î≥ÄÌôò Í≤∞Í≥º</div>
                </div>
            </div>
        </div>

        <div class="grid">
            <button class="func" onclick="clearAll()">AC</button>
            <button class="func" onclick="del()">DEL</button>
            <button class="op" onclick="input('(')">(</button><button class="op" onclick="input(')')">)</button>
            <button onclick="input('7')">7</button><button onclick="input('8')">8</button><button onclick="input('9')">9</button>
            <button class="op" onclick="input('/')">√∑</button>
            <button onclick="input('4')">4</button><button onclick="input('5')">5</button><button onclick="input('6')">6</button>
            <button class="op" onclick="input('*')">√ó</button>
            <button onclick="input('1')">1</button><button onclick="input('2')">2</button><button onclick="input('3')">3</button>
            <button class="op" onclick="input('-')">-</button>
            <button style="grid-column: span 2;" onclick="input('0')">0</button><button onclick="input('.')">.</button>
            <button class="op" onclick="input('+')">+</button>
            <button class="op" style="grid-column: span 4; background:#fff; color:#000" onclick="exe()">=</button>
        </div>
    </div>

    <script>
        const screen = document.getElementById('screen');
        let currentMode = 'standard';

        const units = {
            length: { m: 1, km: 1000, cm: 0.01, mm: 0.001, inch: 0.0254, ft: 0.3048 },
            weight: { kg: 1, g: 0.001, mg: 0.000001, lb: 0.453592, oz: 0.0283495 }
        };

        function setMode(m, btn) {
            currentMode = m;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById('sci-container').classList.toggle('active', m === 'scientific');
            document.getElementById('cur-container').classList.toggle('active', m === 'currency');
            document.getElementById('unit-container').classList.toggle('active', m === 'unit');
            if(m === 'unit') updateUnitOptions();
            if(m === 'currency') convertCurrency();
            clearAll();
        }

        function input(v) {
            if (screen.value === "0" && v !== '.') screen.value = v;
            else screen.value += v;
            updateRealtime();
        }

        function updateRealtime() {
            if(currentMode === 'currency') convertCurrency();
            if(currentMode === 'unit') convertUnit();
        }

        function clearAll() { screen.value = "0"; updateRealtime(); }
        function del() { screen.value = screen.value.slice(0, -1) || "0"; updateRealtime(); }

        function exe() {
            try {
                let expression = screen.value.replace(/√ó/g, '*').replace(/√∑/g, '/');
                // Í¥ÑÌò∏ ÏûêÎèô Îã´Í∏∞ Î≥¥Ï†ï
                const openCount = (expression.match(/\(/g) || []).length;
                const closeCount = (expression.match(/\)/g) || []).length;
                for(let i=0; i<openCount-closeCount; i++) expression += ')';
                
                let res = eval(expression);
                screen.value = Number.isInteger(res) ? res : res.toFixed(4);
                updateRealtime();
            } catch { screen.value = "Error"; }
        }

        function updateUnitOptions() {
            const type = document.getElementById('unitType').value;
            const fromS = document.getElementById('fromUnit');
            const toS = document.getElementById('toUnit');
            fromS.innerHTML = toS.innerHTML = '';
            Object.keys(units[type]).forEach(u => {
                fromS.add(new Option(u, u));
                toS.add(new Option(u, u));
            });
            convertUnit();
        }

        function convertUnit() {
            const type = document.getElementById('unitType').value;
            const from = document.getElementById('fromUnit').value;
            const to = document.getElementById('toUnit').value;
            const val = parseFloat(screen.value) || 0;
            const res = (val * units[type][from]) / units[type][to];
            document.getElementById('unitResultLabel').innerText = `${val} ${from} = ${res.toLocaleString(undefined,{maximumFractionDigits:4})} ${to}`;
        }

        async function convertCurrency() {
            const from = document.getElementById('fromCurr').value;
            const to = document.getElementById('toCurr').value;
            const amount = parseFloat(screen.value) || 0;
            try {
                const res = await fetch(`https://open.er-api.com/v6/latest/${from}`);
                const data = await res.json();
                const rate = data.rates[to];
                document.getElementById('currResultLabel').innerText = (amount * rate).toLocaleString(undefined, {maximumFractionDigits:2}) + " " + to;
                document.getElementById('currInputLabel').innerText = amount.toLocaleString() + " " + from;
                const now = new Date();
                document.getElementById('curInfoBar').innerText = `${now.toLocaleDateString()} ${now.getHours()}:${now.getMinutes().toString().padStart(2,'0')} | 1 ${from} = ${rate.toFixed(2)} ${to}`;
            } catch (e) { }
        }
    </script>
</body>
</html>