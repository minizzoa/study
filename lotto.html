<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ëœë¤ ë½‘ê¸° - ì‚¬ìš´ë“œ ì—ë””ì…˜</title>
    <style>
        :root {
            --bg-dark: #0a0f14;
            --neon-mint: #00ffcc;
            --mint-glow: rgba(0, 255, 204, 0.6);
        }

        body {
            font-family: 'Pretendard', sans-serif;
            background: var(--bg-dark);
            margin: 0;
            padding: 10px 10px 30px 10px;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center; 
            min-height: 100vh;
        }

        h2 { 
            margin: 5px 0 10px 0; 
            font-size: 1.3rem;
            color: var(--neon-mint); 
            text-shadow: 0 0 10px var(--mint-glow);
        }

        .results-container {
            height: 55px; width: 95%; max-width: 500px;
            display: flex; align-items: center; justify-content: center;
            gap: 8px; padding: 5px 10px; background: rgba(0,0,0,0.4);
            border-radius: 30px; border: 1px solid var(--neon-mint);
            margin-bottom: 15px; overflow-x: auto;
        }

        .result-ball {
            min-width: 38px; height: 38px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 1rem; font-weight: 900; color: #000; flex-shrink: 0;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .lucky-machine { position: relative; margin-bottom: 10px; }

        .glass-dome {
            width: 200px; height: 200px;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
            border-radius: 50%; border: 2px solid rgba(255,255,255,0.2);
            position: relative; overflow: hidden; z-index: 5;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.8);
        }

        .mixing-ball {
            position: absolute; width: 24px; height: 24px; border-radius: 50%;
            box-shadow: inset -2px -2px 4px rgba(0,0,0,0.4); z-index: 6;
        }

        @keyframes shuffle {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(var(--rx), var(--ry)) rotate(90deg); }
            50% { transform: translate(var(--bx), var(--by)) rotate(180deg); }
            75% { transform: translate(var(--gx), var(--gy)) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        .is-mixing .mixing-ball { animation: shuffle var(--speed) infinite linear; }

        .machine-body {
            width: 180px; height: 100px;
            background: linear-gradient(135deg, var(--neon-mint), #00cca3);
            border-radius: 0 0 50px 50px; margin: -30px auto 0;
            position: relative; z-index: 1; border: 3px solid #00dfb2;
        }

        .exit-slot {
            position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%);
            width: 60px; height: 60px; background: #121212;
            border-radius: 50%; border: 3px solid #1a1a1a;
            box-shadow: inset 0 5px 15px rgba(0,0,0,1);
        }

        #activeBallSlot {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 80px; height: 80px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 2.5rem; font-weight: 900; color: #000;
            opacity: 0; z-index: 999; filter: drop-shadow(0 0 15px #fff);
        }

        #activeBallSlot.drop { 
            opacity: 1; transform: translate(-50%, -130px) scale(1.1);
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }

        .sidebar {
            background: rgba(255,255,255,0.07); padding: 15px;
            border-radius: 25px; width: 90%; max-width: 400px;
            display: flex; flex-direction: column; gap: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .setting-row { display: flex; gap: 10px; }
        .setting-item { flex: 1; display: flex; flex-direction: column; gap: 5px; }
        .setting-item label { font-size: 0.75rem; color: var(--neon-mint); text-align: center; }
        .setting-item input { 
            width: 100%; padding: 10px 0; border-radius: 10px; border: none; background: #1a1a1a; 
            color: var(--neon-mint); font-size: 1.2rem; text-align: center; font-weight: 800;
        }

        #drawBtn {
            width: 100%; padding: 15px; font-size: 1.3rem; font-weight: 900;
            background: var(--neon-mint); color: #000; border: none; border-radius: 15px;
            box-shadow: 0 0 15px var(--mint-glow); cursor: pointer;
        }

        .home-section { margin-top: 30px; padding-bottom: 20px; }
        .btn-home {
            background: transparent; color: #666; border: 1px solid #333;
            padding: 10px 30px; border-radius: 25px; font-size: 0.9rem;
            display: flex; align-items: center; gap: 8px; text-decoration: none;
        }

        @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <h2>âš¡ DYNAMIC SOUND LOTTO âš¡</h2>

    <div class="results-container" id="results"></div>

    <div class="lucky-machine" id="machineArea">
        <div class="glass-dome" id="dome">
            <div id="ballPit"></div>
        </div>
        <div class="machine-body"><div class="exit-slot"></div></div>
        <div id="activeBallSlot">?</div>
    </div>

    <div class="sidebar">
        <div class="setting-row">
            <div class="setting-item">
                <label>ë½‘ì„ ê°œìˆ˜</label>
                <input type="number" id="ballCount" value="6" min="1" max="20">
            </div>
            <div class="setting-item">
                <label>ìˆ«ì ë²”ìœ„</label>
                <input type="number" id="maxRange" value="45" min="1">
            </div>
        </div>
        <button id="drawBtn">ë½‘ ê¸° ì‹œ ì‘</button>
        <div id="soundToggle" style="text-align:center; font-size:0.8rem; color:#555; cursor:pointer;">ğŸ”Š ì‚¬ìš´ë“œ ON</div>
    </div>

    <div class="home-section">
        <a href="index.html" class="btn-home">ğŸ  HOME</a>
    </div>

    <script>
        const ballPit = document.getElementById('ballPit');
        const dome = document.getElementById('dome');
        const drawBtn = document.getElementById('drawBtn');
        const activeBallSlot = document.getElementById('activeBallSlot');
        const resultsContainer = document.getElementById('results');
        const soundToggle = document.getElementById('soundToggle');

        const ballColors = ['#FF006E', '#8338EC', '#00F5D4', '#FFBE0B', '#FB5607', '#3A86FF'];
        let isMuted = false;
        
        // ì‚¬ìš´ë“œ ê´€ë ¨ ë³€ìˆ˜
        let audioCtx = null;
        let mixOscillator = null;
        let mixGain = null;

        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        // ê³µ ë½‘í ë•Œ "ëµ" ì†Œë¦¬
        function playPickSound() {
            if (isMuted || !audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(880, audioCtx.currentTime); // ê³ ìŒ
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.5);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.5);
        }

        // ê³µ ì„ì´ëŠ” "ë‹¬ê·¸ë½" ì†Œë¦¬ ì‹œì‘
        function startMixingSound() {
            if (isMuted || !audioCtx) return;
            mixOscillator = audioCtx.createOscillator();
            mixGain = audioCtx.createGain();
            mixOscillator.type = 'triangle';
            mixOscillator.frequency.setValueAtTime(110, audioCtx.currentTime); // ì €ìŒ
            
            // ì£¼íŒŒìˆ˜ ë³€ì¡°ë¡œ ë‹¬ê·¸ë½ê±°ë¦¬ëŠ” ëŠë‚Œ ìƒì„±
            const lfo = audioCtx.createOscillator();
            lfo.frequency.setValueAtTime(15, audioCtx.currentTime); 
            const lfoGain = audioCtx.createGain();
            lfoGain.gain.setValueAtTime(50, audioCtx.currentTime);
            lfo.connect(lfoGain); lfoGain.connect(mixOscillator.frequency);
            
            mixGain.gain.setValueAtTime(0.02, audioCtx.currentTime);
            mixOscillator.connect(mixGain); mixGain.connect(audioCtx.destination);
            
            lfo.start(); mixOscillator.start();
        }

        // ì‚¬ìš´ë“œ ì¤‘ë‹¨
        function stopMixingSound() {
            if (mixOscillator) {
                mixOscillator.stop();
                mixOscillator = null;
            }
        }

        function createBalls() {
            ballPit.innerHTML = '';
            for(let i=0; i<30; i++) {
                const b = document.createElement('div');
                b.className = 'mixing-ball';
                const rx = Math.random() * 150 - 75;
                const ry = Math.random() * 150 - 75;
                const bx = Math.random() * 150 - 75;
                const by = Math.random() * 150 - 75;
                const speed = (0.3 + Math.random() * 0.4) + 's';
                b.style.backgroundColor = ballColors[i % ballColors.length];
                b.style.left = '85px'; b.style.top = '85px';
                b.style.setProperty('--rx', rx + 'px'); b.style.setProperty('--ry', ry + 'px');
                b.style.setProperty('--bx', bx + 'px'); b.style.setProperty('--by', by + 'px');
                b.style.setProperty('--gx', -rx + 'px'); b.style.setProperty('--gy', -ry + 'px');
                b.style.setProperty('--speed', speed);
                ballPit.appendChild(b);
            }
        }

        async function startDrawing() {
            initAudio();
            if (audioCtx.state === 'suspended') audioCtx.resume();

            const count = parseInt(document.getElementById('ballCount').value);
            const max = parseInt(document.getElementById('maxRange').value);
            if (count > max) return alert("ë²”ìœ„ ì˜¤ë¥˜!");

            drawBtn.disabled = true;
            resultsContainer.innerHTML = '';
            dome.classList.add('is-mixing');
            startMixingSound(); // ì„ê¸° ì†Œë¦¬ ì‹œì‘
            
            let picked = [];

            for (let i = 0; i < count; i++) {
                await new Promise(r => setTimeout(r, 600)); 

                let num;
                do { num = Math.floor(Math.random() * max) + 1; } while (picked.includes(num));
                picked.push(num);

                const color = ballColors[Math.floor(Math.random() * ballColors.length)];
                activeBallSlot.style.background = `radial-gradient(circle at 30% 30%, #fff, ${color})`;
                activeBallSlot.innerText = num;
                activeBallSlot.classList.add('drop');
                playPickSound(); // ë½‘ê¸° ì†Œë¦¬
                
                await new Promise(r => setTimeout(r, 800));

                const resBall = document.createElement('div');
                resBall.className = 'result-ball';
                resBall.style.background = `radial-gradient(circle at 30% 30%, #fff, ${color})`;
                resBall.innerText = num;
                resultsContainer.appendChild(resBall);
                resultsContainer.scrollTo({ left: resultsContainer.scrollWidth, behavior: 'smooth' });

                activeBallSlot.classList.remove('drop');
            }

            dome.classList.remove('is-mixing');
            stopMixingSound(); // ì„ê¸° ì†Œë¦¬ ì¤‘ë‹¨
            drawBtn.disabled = false;
        }

        soundToggle.addEventListener('click', () => {
            isMuted = !isMuted;
            soundToggle.innerText = isMuted ? "ğŸ”‡ ì‚¬ìš´ë“œ OFF" : "ğŸ”Š ì‚¬ìš´ë“œ ON";
            if (isMuted) stopMixingSound();
        });

        drawBtn.addEventListener('click', startDrawing);
        createBalls();
    </script>
</body>
</html>